# DockSync
DockSync - это аддон для PulseSync, разработанный специально для возможности управления приложением Яндекс.Музыки через мини-клавиатуры

## Использование
Для использования аддона, необходимо:
1. Убедиться, что установлена последняя версия [PulseSync](pulsesync.dev) и последняя версия мода для Яндекс.Музыки
2. Установить [последнюю версию аддона](https://github.com/AnimeLore/DockSync/releases/)
3. Установить плагин для MiraBox/Ajazz интерфейса
4. Запустить интерфейс MiraBox/Ajazz и Яндекс.Музыку в любом порядке

Примечание: Аддон является базой и без доп. плагинов, установленных на оборудование - работать не будет. Приложение PulseSync является обязательным для корректной работы аддона.

## Методы для разработки
Аддон принимает запросы по WebSocket, для корректной работы необходимо чтобы ваш плагин **самостоятельно** поднимал WebSocket сервер по определенному порту. Порт можно изменить в настройках аддона.

### Список доступных запросов и примеры их использования

Шаблон любого запроса плагина:
```json
{
"request": "requestId",
"message": "requestMessage"
}
```

Поле `request` является обязательным и используется для понимания вида команды, отправленной плагином.

Поле `message` является необязательным и используется для основного дополнительного параметра команды.

### Пример базового запроса
```json
{
"request": "device"
}
```
Данный запрос используется как тестовый. Если WebSocket верно настроен - в DevTools консоли Яндекс.Музыки появится сообщение `Плагин успешно подключился к доку!`.


#### Запросы влияющие на плеер


##### `volume` - используется для управления громкостью плеера
```json
{
"request": "volume",
"message": 0.2,
"how": 1
}
```
`message` - количество на которое нужно увеличить/уменьшить громкость плеера

`how` - направление изменения, может равняться `-1` или `1`

&nbsp;

##### `track` - используется для управления треком
```json
{
"request": "track",
"message": 1,
}
```
`message` - указывает в каком направлении нужно "дввинуть" плеер (следующий трек/предыдущий трек),  может равняться `-1` или `1`

&nbsp;

##### `repeatInteraction` - используется для управления функцией повтора плеера
```json
{
"request": "repeatInteraction",
}
```
Данный функционал эмулирует нажатие на кнопку в плеера и не поддерживает установку определенного значения :(

&nbsp;

##### `shuffleInteraction` - используется для управления функцией перемешки плеера
```json
{
"request": "shuffleInteraction",
}
```
Данный функционал эмулирует нажатие на кнопку в плеера и не поддерживает установку определенного значения :(

&nbsp;

##### `muteInteraction` - используется для управления функцией выключения звука плеера
```json
{
"request": "muteInteraction",
}
```
Данный функционал эмулирует нажатие на кнопку в плеера и не поддерживает установку определенного значения :(


&nbsp;

##### `playerInteraction` - используется для управления паузой/воспроизведением треков в плеере
```json
{
"request": "playerInteraction",
}
```
Данный функционал эмулирует нажатие на кнопку в плеера и не поддерживает установку определенного значения :(


&nbsp;

##### `likeInteraction` - используется для добавления/удаления трека из избранного
```json
{
"request": "likeInteraction",
}
```
Данный функционал эмулирует нажатие на кнопку в плеера и не поддерживает установку определенного значения :(

&nbsp;

##### `dislikeInteraction` - используется для добавления/удаления трека из игнорируемых
```json
{
"request": "dislikeInteraction",
}
```
Данный функционал эмулирует нажатие на кнопку в плеера и не поддерживает установку определенного значения :(

&nbsp;
#### Запросы, возвращающие информацию о плеере
При отправке любого из этих запросов, аддон ответит схожим запросом на WebSocket с запрошенной информацией в параметре `message`

&nbsp;
##### `repeatState` - возвращает текущее состояние повтора плеера, имеет значения:
- 0 - Повтор выключен
- 1 - Повтор включен для плейлиста
- 2 - Повтор включен для одного трека

Отправляемый запрос из плагина:
```json
{
"request": "repeatState",
}
```
Ответ от аддона:
```json
{
"request": "repeatState",
"message": 1
}
```

&nbsp;
##### `shuffleState` - возвращает текущее состояние перемешки треков плеера, имеет значения:
- 0 - Шаффл выключен
- 1 - Шаффл включен

Отправляемый запрос из плагина:
```json
{
"request": "shuffleState",
}
```
Ответ от аддона:
```json
{
"request": "shuffleState",
"message": 1
}
```

&nbsp;
##### `likeState` - возвращает текущее состояние лайка плеера, имеет значения:
- 0 - Трек не лайкнут
- 1 - Трек лайкнут

Отправляемый запрос из плагина:
```json
{
"request": "likeState",
}
```
Ответ от аддона:
```json
{
"request": "likeState",
"message": 1
}
```

&nbsp;
##### `playingState` - возвращает текущее состояние плеера, имеет значения:
- 0 - Плеер играет
- 1 - Плеер на паузе

Отправляемый запрос из плагина:
```json
{
"request": "playingState",
}
```
Ответ от аддона:
```json
{
"request": "playingState",
"message": 1
}
```

## Благодарности
- Спасибо разработчикам PulseSync за удобный интерфейс и обработку плагинов
- Спасибо [WolfySoCute](https://github.com/WolfySoCute) за вдохновение и примеры работы WebSocket
- Спасибо [foreA-adoxid](https://github.com/foreA-adoxid) за ночные разговоры об window.sonataState
